<mat-expansion-panel [ngStyle]="{'border-color': datasetOptions.color}">
  <mat-expansion-panel-header>
    <mat-panel-title>
      <div class="title" [ngClass]="{'noData': !hasData}">
        <div>
          <n52-label-mapper label="{{phenomenonLabel}}"></n52-label-mapper>
          <span *ngIf="uom">
            <span> [<n52-label-mapper label="{{uom}}"></n52-label-mapper>] </span>
          </span>
        </div>
        <div>{{dataset?.platform.label}}</div>
      </div>
      <div style="flex: 1"></div>
      <button mat-icon-button (click)="removeDataset(); $event.stopPropagation()">
        <mat-icon>clear</mat-icon>
      </button>
    </mat-panel-title>
  </mat-expansion-panel-header>
  <div>
    <div class="small-label">
      <n52-label-mapper label="{{procedureLabel}}"></n52-label-mapper>
      <span *ngIf="categoryLabel != phenomenonLabel">
        - <n52-label-mapper label="{{categoryLabel}}"></n52-label-mapper>
      </span>
    </div>
    <div class="controls">
      <button mat-icon-button (click)="toggleSelection(); $event.stopPropagation()">
        <mat-icon [color]="selected ? 'accent' : ''">priority_high</mat-icon>
      </button>
      <button mat-icon-button (click)="toggleVisibility(); $event.stopPropagation()">
        <mat-icon>{{datasetOptions.visible ? 'visibility' : 'visibility_off'}}</mat-icon>
      </button>
      <button mat-icon-button (click)="showGeometry(); $event.stopPropagation()">
        <mat-icon>room</mat-icon>
      </button>
      <button mat-icon-button (click)="editDatasetOptions(); $event.stopPropagation()">
        <mat-icon [ngStyle]="{'color': datasetOptions.color}">create</mat-icon>
      </button>
      <button mat-icon-button (click)="$event.stopPropagation()">
        <mat-icon>star</mat-icon>
      </button>
    </div>
    <div class="entry-line clickable" *ngIf="firstValue" (click)="jumpToFirstTimeStamp(); $event.stopPropagation();">
      <span>{{'diagram-view.legend.entry.first-value-at' | translate}}: </span>
      <span> {{firstValue.timestamp | date: 'short': null : translateSrvc.currentLang}} </span>
      <span>({{firstValue.value}} {{uom}})</span>
    </div>
    <div class="entry-line clickable" *ngIf="lastValue" (click)="jumpToLastTimeStamp(); $event.stopPropagation();">
      <span>{{'diagram-view.legend.entry.last-value-at' | translate}}: </span>
      <span> {{lastValue.timestamp | date: 'short' : null : translateSrvc.currentLang}} </span>
      <span>({{lastValue.value}} {{uom}})</span>
    </div>
    <div *ngIf="dataset?.referenceValues">
      <div>{{'diagram-view.legend-reference-values' | translate}}: </div>
      <mat-slide-toggle *ngFor="let ref of dataset.referenceValues" [checked]="ref.visible"
        (toggleChange)="toggleReferenceValue(ref)">
        <span [ngStyle]="{color: ref.color}">{{ref.label}}</span>
      </mat-slide-toggle>
    </div>
  </div>
</mat-expansion-panel>
