<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>helgoland-toolbox documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">helgoland-toolbox documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li>LocalHttpCacheIntervalInterceptor</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts</code>
        </p>




            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#expirationAtMs">expirationAtMs</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#concatReferenceValues">concatReferenceValues</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#createHttpResponse">createHttpResponse</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#decodeID">decodeID</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#decodeTimespan">decodeTimespan</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#encodeTimespan">encodeTimespan</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#getUrlWithoutParams">getUrlWithoutParams</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#intercept">intercept</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#selectValueAfterTimespan">selectValueAfterTimespan</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#selectValueBeforeTimespan">selectValueBeforeTimespan</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(cache: <a href="../interfaces/Cache.html">HttpCacheInterval</a>, config: <a href="../interfaces/CacheConfig.html">CacheConfig</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="23" class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:23</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>cache</td>
                                                  
                                                        <td>
                                                                        <code><a href="../interfaces/Cache.html" target="_self" >HttpCacheInterval</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>config</td>
                                                  
                                                        <td>
                                                                        <code><a href="../interfaces/CacheConfig.html" target="_self" >CacheConfig</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="concatReferenceValues"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            concatReferenceValues
                        </b>
                        <a href="#concatReferenceValues"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>concatReferenceValues(base: <a href="../injectables/Time.html">Data<TimeValueTuple></a>, adds: <a href="../injectables/Time.html">Data<TimeValueTuple></a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="234"
                            class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:234</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Function to combine data of referenceValues.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>base</td>
                                    <td>
                                                <code><a href="../injectables/Time.html" target="_self" >Data&lt;TimeValueTuple&gt;</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>array of values</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>adds</td>
                                    <td>
                                                <code><a href="../injectables/Time.html" target="_self" >Data&lt;TimeValueTuple&gt;</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>array of values</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../injectables/Time.html" target="_self" >ReferenceValues&lt;TimeValueTuple&gt;</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="createHttpResponse"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            createHttpResponse
                        </b>
                        <a href="#createHttpResponse"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>createHttpResponse(urlID: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, expanded: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank">boolean</a>, httpResponse: HttpResponse<any>, intersected: <a href="../interfaces/CachedIntersection.html">CachedIntersection</a>, newCachedObject?: <a href="../interfaces/CachedObject.html">CachedObject</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="178"
                            class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:178</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Concat values of all intersected objects into a http response.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>urlID</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>expanded</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>httpResponse</td>
                                    <td>
                                            <code>HttpResponse&lt;any&gt;</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>intersected</td>
                                    <td>
                                                <code><a href="../interfaces/CachedIntersection.html" target="_self" >CachedIntersection</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>newCachedObject</td>
                                    <td>
                                                <code><a href="../interfaces/CachedObject.html" target="_self" >CachedObject</a></code>
                                    </td>

                                    <td>
                                        Yes
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../interfaces/Event.html" target="_self" >HttpEvent&lt;any&gt;</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="decodeID"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            decodeID
                        </b>
                        <a href="#decodeID"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>decodeID(url: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="283"
                            class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:283</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Get id from request url.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>url</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>url</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="decodeTimespan"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            decodeTimespan
                        </b>
                        <a href="#decodeTimespan"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>decodeTimespan(ts: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="264"
                            class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:264</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Function to decode a string to a timespan.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ts</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>timespan as string format</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../injectables/Time.html" target="_self" >Timespan</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="encodeTimespan"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            encodeTimespan
                        </b>
                        <a href="#encodeTimespan"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>encodeTimespan(timespan: <a href="../injectables/Time.html">Timespan</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="275"
                            class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:275</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Function to encode timespan to a string format.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>timespan</td>
                                    <td>
                                                <code><a href="../injectables/Time.html" target="_self" >Timespan</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>timespan to be encoded to a string format</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getUrlWithoutParams"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            getUrlWithoutParams
                        </b>
                        <a href="#getUrlWithoutParams"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>getUrlWithoutParams(url: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="255"
                            class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:255</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Function to identify only the url with id without any request parameters.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>url</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>url of a request</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="intercept"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Public</span>
                            intercept
                        </b>
                        <a href="#intercept"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>intercept(req: HttpRequest<any>, metadata: <a href="../interfaces/HttpRequestOptions.html">HttpRequestOptions</a>, next: <a href="../injectables/HttpService.html">HttpServiceHandler</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="38"
                            class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:38</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Interceptor for caching data for specific time intervals.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>req</td>
                                    <td>
                                            <code>HttpRequest&lt;any&gt;</code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>original request</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>metadata</td>
                                    <td>
                                                <code><a href="../interfaces/HttpRequestOptions.html" target="_self" >HttpRequestOptions</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>further specification of the original request</p>

                                    </td>
                                </tr>
                                <tr>
                                    <td>next</td>
                                    <td>
                                                <code><a href="../injectables/HttpService.html" target="_self" >HttpServiceHandler</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>forward to further functions</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../interfaces/Event.html" target="_self" >Observable&lt;HttpEvent&lt;any&gt;&gt;</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="selectValueAfterTimespan"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            selectValueAfterTimespan
                        </b>
                        <a href="#selectValueAfterTimespan"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>selectValueAfterTimespan(el1: <a href="../injectables/Time.html">Data<TimeValueTuple></a>, el2: <a href="../injectables/Time.html">Data<TimeValueTuple></a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="314"
                            class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:314</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Function to determine valueAfterTimespan based on existing values.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>el1</td>
                                    <td>
                                                <code><a href="../injectables/Time.html" target="_self" >Data&lt;TimeValueTuple&gt;</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>el2</td>
                                    <td>
                                                <code><a href="../injectables/Time.html" target="_self" >Data&lt;TimeValueTuple&gt;</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../injectables/Time.html" target="_self" >TimeValueTuple</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="selectValueBeforeTimespan"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            selectValueBeforeTimespan
                        </b>
                        <a href="#selectValueBeforeTimespan"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>selectValueBeforeTimespan(el1: <a href="../injectables/Time.html">Data<TimeValueTuple></a>, el2: <a href="../injectables/Time.html">Data<TimeValueTuple></a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="295"
                            class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:295</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Function to determine valueBeforeTimespan based on existing values.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>el1</td>
                                    <td>
                                                <code><a href="../injectables/Time.html" target="_self" >Data&lt;TimeValueTuple&gt;</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>el2</td>
                                    <td>
                                                <code><a href="../injectables/Time.html" target="_self" >Data&lt;TimeValueTuple&gt;</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../injectables/Time.html" target="_self" >TimeValueTuple</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="expirationAtMs"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            expirationAtMs</b>
                            <a href="#expirationAtMs"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>30000</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="23" class="link-to-prism">libs/caching/src/lib/get-data-cache/local-http-cache-interval-interceptor.ts:23</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { HttpEvent, HttpRequest, HttpResponse } from &#x27;@angular/common/http&#x27;;
import { Inject, Injectable, Optional } from &#x27;@angular/core&#x27;;
import {
  Data,
  HttpRequestOptions,
  HttpServiceHandler,
  HttpServiceInterceptor,
  ReferenceValues,
  Timespan,
  TimeValueTuple,
} from &#x27;@helgoland/core&#x27;;
import moment from &#x27;moment&#x27;;
import { Observable, Observer } from &#x27;rxjs&#x27;;
import { share } from &#x27;rxjs/operators&#x27;;

import { CacheConfig, CacheConfigService } from &#x27;../config&#x27;;
import { HttpCacheInterval } from &#x27;../model&#x27;;
import { CachedIntersection, CachedObject } from &#x27;./local-http-cache-interval&#x27;;

@Injectable()
export class LocalHttpCacheIntervalInterceptor implements HttpServiceInterceptor {

  private expirationAtMs &#x3D; 30000;

  constructor(
    protected cache: HttpCacheInterval,
    @Optional() @Inject(CacheConfigService) config: CacheConfig
  ) {
    if (config &amp;&amp; config.cachingDurationInMilliseconds) { this.expirationAtMs &#x3D; config.cachingDurationInMilliseconds; }
  }

  /**
   * Interceptor for caching data for specific time intervals.
   * @param req {HttpRequest&lt;any&gt;} original request
   * @param metadata {HttpRequestOptions} further specification of the original request
   * @param next {HttpServiceHandler} forward to further functions
   */
  public intercept(
    req: HttpRequest&lt;any&gt;, metadata: HttpRequestOptions, next: HttpServiceHandler
  ): Observable&lt;HttpEvent&lt;any&gt;&gt; {

    const urlID &#x3D; this.decodeID(req.url);
    let expanded &#x3D; false;
    let generalize &#x3D; false;

    // handle GET and getData requests only
    if (req.method !&#x3D;&#x3D; &#x27;GET&#x27;) {
      return next.handle(req, metadata);
    }
    if (!req.url.includes(&#x27;/getData&#x27;)) {
      return next.handle(req, metadata);
    }
    if (req.urlWithParams.includes(&#x27;expanded&#x3D;true&#x27;)) {
      expanded &#x3D; true;
    }
    if (req.urlWithParams.includes(&#x27;generalize&#x3D;true&#x27;)) {
      generalize &#x3D; true;
    }

    // adapt request if necessary
    const customReqs &#x3D; [];
    const reqOptions &#x3D; [];

    let intersectedCache: CachedIntersection | null;

    if (!metadata.forceUpdate) {
      const reqTimespan &#x3D; this.decodeTimespan(req.params.get(&#x27;timespan&#x27;));
      // check cache for existing timespans
      intersectedCache &#x3D; this.cache.getIntersection(req.url, reqTimespan, generalize);

      if (intersectedCache &amp;&amp; (intersectedCache.timespans.length &#x3D;&#x3D;&#x3D; 0 || (Math.floor(intersectedCache.timespans[0].from / 1000) &#x3D;&#x3D;&#x3D; Math.floor(intersectedCache.timespans[0].to / 1000)))) {
        if (intersectedCache.cachedObjects[0]) {
          // requested timespan is covered by existing cachedObject
          return new Observable&lt;HttpEvent&lt;any&gt;&gt;((observer: Observer&lt;HttpEvent&lt;any&gt;&gt;) &#x3D;&gt; {
            const httpResponse &#x3D; intersectedCache.cachedObjects[0].httpResponse;
            const resHttpEvent &#x3D; this.createHttpResponse(urlID, expanded, httpResponse, intersectedCache);
            observer.next(resHttpEvent); // intersectedCache.cachedObjects[0].httpEvent);
            observer.complete();
          });
        } else {
          // case that there is intersection with cache, but the requested time interval contains no data values
          return new Observable&lt;HttpEvent&lt;any&gt;&gt;((observer: Observer&lt;HttpEvent&lt;any&gt;&gt;) &#x3D;&gt; {
            const body &#x3D; {};
            body[urlID] &#x3D; {
              values: [],
              referenceValues: []
            };
            observer.next(new HttpResponse({
              body: !expanded ? { values: [], referenceValues: [] } : body,
              // headers: ,
              status: 200,
              statusText: &#x27;OK&#x27;,
              url: req.url
            }));
            observer.complete();
          });
          // return next.handle(req, metadata);
        }
      } else {
        // requested timespan is not or not fully covered by existing cachedObjects
        if (intersectedCache &amp;&amp; intersectedCache.timespans.length &gt; 1) {
          // if more than one not covered timespans need to be requested, use origin request only
          // customReqs.push(req);
          // reqOptions.push(metadata);

          // TODO adapt here to handle more than one customized request, see 2 lines below

        } else if (intersectedCache &amp;&amp; intersectedCache.timespans.length &gt; 0) {
          // customize request, if requested timespan is not fully covered by existing cachedObjects
          // currently for one request only
          intersectedCache.timespans.forEach(ts &#x3D;&gt; {
            let params &#x3D; req.params;
            params &#x3D; params.set(&#x27;timespan&#x27;, this.encodeTimespan(ts));
            const cReq &#x3D; req.clone({ params });
            customReqs.push(cReq);
            const cMetadata &#x3D; metadata;
            reqOptions.push(cMetadata);
          });
        }
      }
    }

    let originReq &#x3D; false;
    // use default req &amp; metadata
    if (customReqs.length &#x3D;&#x3D;&#x3D; 0) {
      customReqs.push(req);
      originReq &#x3D; true;
    }
    if (reqOptions.length &#x3D;&#x3D;&#x3D; 0) { reqOptions.push(metadata); }

    const newRequest &#x3D; customReqs[0];
    const newOptions &#x3D; reqOptions[0];

    // use origin request for not covered timespans
    // or use custom request for not fully covered timespans
    return new Observable&lt;HttpEvent&lt;any&gt;&gt;((observer: Observer&lt;HttpEvent&lt;any&gt;&gt;) &#x3D;&gt; {
      const shared &#x3D; next.handle(newRequest, newOptions).pipe(share());
      shared.subscribe((res) &#x3D;&gt; {
        if (res instanceof HttpResponse) {
          const expirationTime &#x3D; metadata.expirationAtMs ? metadata.expirationAtMs : this.expirationAtMs;
          const resultUrl &#x3D; this.getUrlWithoutParams(res.url);
          // for ts data
          const cachedItem: CachedObject &#x3D; {
            values: !expanded ? res.body : res.body[urlID],
            expirationDate: moment(moment(new Date())).add(expirationTime, &#x27;milliseconds&#x27;).toDate(),
            expirationAtMs: expirationTime,
            httpResponse: res,
            requestTs: this.decodeTimespan(newRequest.params.get(&#x27;timespan&#x27;))
          };
          if (cachedItem.values.values.length &gt; 0) {
            // update cache
            this.cache.put(resultUrl, cachedItem, generalize, originReq);
          }
          if (!originReq &amp;&amp; intersectedCache &amp;&amp; intersectedCache.cachedObjects.length &gt; 0) {
            if (cachedItem.values.values.length &gt; 0) {
              res &#x3D; this.createHttpResponse(urlID, expanded, res, intersectedCache, cachedItem);
            } else {
              res &#x3D; this.createHttpResponse(urlID, expanded, res, intersectedCache);
            }
          }
          observer.next(res);
          observer.complete();
        }

      }, (error) &#x3D;&gt; {
        observer.error(error);
        observer.complete();
      });
    });

  }

  /**
   * Concat values of all intersected objects into a http response.
   * @param intersected
   * @param newCachedObject
   */
  private createHttpResponse(urlID: string, expanded: boolean, httpResponse: HttpResponse&lt;any&gt;, intersected: CachedIntersection, newCachedObject?: CachedObject): HttpEvent&lt;any&gt; {
    const resObj: Data&lt;TimeValueTuple&gt; &#x3D; intersected.cachedObjects[0].values;
    let newObjValuesTimespan: Timespan;
    if (newCachedObject) {
      // add values of new cached object at the beginning
      newObjValuesTimespan &#x3D; new Timespan(newCachedObject.values.values[0][0], newCachedObject.values.values[newCachedObject.values.values.length - 1][0]);
      if (newObjValuesTimespan.to &lt;&#x3D; resObj.values[0][0]) {
        resObj.values &#x3D; newCachedObject.values.values.concat(resObj.values);
        resObj.referenceValues &#x3D; this.concatReferenceValues(resObj, newCachedObject.values);
        resObj.valueBeforeTimespan &#x3D; this.selectValueBeforeTimespan(resObj, newCachedObject.values);
        resObj.valueAfterTimespan &#x3D; this.selectValueAfterTimespan(resObj, newCachedObject.values);
      }

    }
    for (let i &#x3D; 1; i &lt; intersected.cachedObjects.length; i++) {
      const currVal &#x3D; intersected.cachedObjects[i].values;
      // add values of new cached object inbetween
      if (newCachedObject &amp;&amp; newObjValuesTimespan.from &gt;&#x3D; resObj.values[resObj.values.length - 1][0] &amp;&amp; newObjValuesTimespan.to &lt;&#x3D; currVal.values[0][0]) {
        resObj.values &#x3D; resObj.values.concat(newCachedObject.values.values);
        resObj.referenceValues &#x3D; this.concatReferenceValues(newCachedObject.values, resObj);
        resObj.valueBeforeTimespan &#x3D; this.selectValueBeforeTimespan(resObj, newCachedObject.values);
        resObj.valueAfterTimespan &#x3D; this.selectValueAfterTimespan(resObj, newCachedObject.values);
      }
      resObj.values &#x3D; resObj.values.concat(currVal.values);
      resObj.referenceValues &#x3D; this.concatReferenceValues(currVal, resObj);
      // add values of new cached object at the end
      if (i &gt;&#x3D; intersected.cachedObjects.length - 1 &amp;&amp; newCachedObject &amp;&amp; newObjValuesTimespan.from &gt;&#x3D; currVal.values[currVal.values.length - 1][0]) {
        resObj.values &#x3D; resObj.values.concat(newCachedObject.values.values);
        resObj.referenceValues &#x3D; this.concatReferenceValues(newCachedObject.values, resObj);
      }
      resObj.valueBeforeTimespan &#x3D; this.selectValueBeforeTimespan(resObj, currVal);
      resObj.valueAfterTimespan &#x3D; this.selectValueAfterTimespan(resObj, currVal);
    }
    if (resObj.valueBeforeTimespan &amp;&amp; resObj.valueBeforeTimespan[0] &gt; resObj.values[0][0]) {
      resObj.valueBeforeTimespan &#x3D; resObj.values[0];
    }
    if (resObj.valueAfterTimespan &amp;&amp; resObj.valueAfterTimespan[0] &lt; resObj.values[resObj.values.length - 1][0]) {
      resObj.valueAfterTimespan &#x3D; resObj.values[resObj.values.length - 1];
    }

    const body &#x3D; {};
    body[urlID] &#x3D; resObj;
    return new HttpResponse({
      body: !expanded ? resObj : body,
      headers: httpResponse.headers,
      status: httpResponse.status,
      statusText: httpResponse.statusText,
      url: httpResponse.url
    });
  }

  /**
   * Function to combine data of referenceValues.
   * @param base {Data&lt;TimeValueTuple&gt;} array of values
   * @param adds {Data&lt;TimeValueTuple&gt;} array of values
   */
  private concatReferenceValues(base: Data&lt;TimeValueTuple&gt;, adds: Data&lt;TimeValueTuple&gt;): ReferenceValues&lt;TimeValueTuple&gt; {
    const res: ReferenceValues&lt;TimeValueTuple&gt; &#x3D; Object.assign({}, base.referenceValues);
    Object.assign(res, adds.referenceValues);
    for (const key in res) {
      if (key) {
        if (base.referenceValues[key]) {
          // combine base and adds values with same key
          res[key] &#x3D; res[key].concat(base.referenceValues[key].filter(item &#x3D;&gt; res[key].findIndex(el &#x3D;&gt; el[0] &#x3D;&#x3D;&#x3D; item[0]) &lt; 0));
          // sort
          res[key] &#x3D; res[key].sort((a, b) &#x3D;&gt; (a[0] &gt; b[0]) ? 1 : ((b[0] &gt; a[0]) ? -1 : 0));
          res[key] &#x3D; res[key].filter(item &#x3D;&gt; item[0]);
        }
      }
    }
    return res;
  }

  /**
   * Function to identify only the url with id without any request parameters.
   * @param url {string} url of a request
   */
  private getUrlWithoutParams(url: string): string {
    const end &#x3D; url.indexOf(&#x27;?&#x27;);
    return url.substring(0, end);
  }

  /**
   * Function to decode a string to a timespan.
   * @param ts {string} timespan as string format
   */
  private decodeTimespan(ts: string): Timespan {
    const idx &#x3D; ts.indexOf(&#x27;/&#x27;);
    const start &#x3D; ts.substring(0, idx);
    const end &#x3D; ts.substring(idx + 1);
    return new Timespan(Math.min(moment(new Date(start)).unix() * 1000, moment(new Date(end)).unix() * 1000), Math.max(moment(new Date(start)).unix() * 1000, moment(new Date(end)).unix() * 1000));
  }

  /**
   * Function to encode timespan to a string format.
   * @param timespan {Timespan} timespan to be encoded to a string format
   */
  private encodeTimespan(timespan: Timespan): string {
    return (moment(timespan.from).format() + &#x27;/&#x27; + moment(timespan.to).format());
  }

  /**
   * Get id from request url.
   * @param url {string} url
   */
  private decodeID(url: string): string {
    const idx &#x3D; url.indexOf(&#x27;/getData&#x27;);
    const start &#x3D; url.substring(0, idx);
    const idxID &#x3D; start.lastIndexOf(&#x27;/&#x27;) + 1;
    return start.substring(idxID);
  }

  /**
   * Function to determine valueBeforeTimespan based on existing values.
   * @param el1 {Data&lt;TimeValueTuple&gt;}
   * @param el2 {Data&lt;TimeValueTuple&gt;}
   */
  private selectValueBeforeTimespan(el1: Data&lt;TimeValueTuple&gt;, el2: Data&lt;TimeValueTuple&gt;): TimeValueTuple {
    if (el1.valueBeforeTimespan) {
      if (el2.valueBeforeTimespan) {
        return el1.valueBeforeTimespan[0] &lt; el2.valueBeforeTimespan[0] ? el1.valueBeforeTimespan : el2.valueBeforeTimespan;
      } else {
        return el1.valueBeforeTimespan;
      }
    }
    if (el2.valueBeforeTimespan) {
      return el2.valueBeforeTimespan;
    }
    return undefined;
  }

  /**
   * Function to determine valueAfterTimespan based on existing values.
   * @param el1 {Data&lt;TimeValueTuple&gt;}
   * @param el2 {Data&lt;TimeValueTuple&gt;}
   */
  private selectValueAfterTimespan(el1: Data&lt;TimeValueTuple&gt;, el2: Data&lt;TimeValueTuple&gt;): TimeValueTuple {
    if (el1.valueAfterTimespan) {
      if (el2.valueAfterTimespan) {
        return el1.valueAfterTimespan[0] &lt; el2.valueAfterTimespan[0] ? el1.valueAfterTimespan : el2.valueAfterTimespan;
      } else {
        return el1.valueAfterTimespan;
      }
    }
    if (el2.valueAfterTimespan) {
      return el2.valueAfterTimespan;
    }
    return undefined;
  }
}
</code></pre>
    </div>

</div>







                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'LocalHttpCacheIntervalInterceptor.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
